%%
%% This is file `latex-lab-testphase-new-or-2.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% latex-lab-new-or-2.dtx  (with options: `package')
%% 
%% This is a generated file.
%% 
%% Copyright 2021-2023 LaTeX Project
%% 
%% This file was generated from file(s) of the  `LaTeX-lab Bundle'.
%% ------------------------------------------------------------------------------------
%% 
%% It may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3c
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.3c or later is part of all distributions of LaTeX
%% version 2008 or later.
%% 
%% This file may only be distributed together with a copy of the LaTeX
%% `LaTeX-lab Bundle'. You may however distribute the `LaTeX-lab Bundle'
%% without such generated files.
%% 
%% The newest sources can be found below
%% 
%%    https://github.com/latex3/latex2e/required/latex-lab
%% 
%% where one can also log issues in case there are any.
%% 
%% 
%% File: latex-lab-new-or-2.dtx
\def\ltlabneworIIdate{2023-09-04}
\def\ltlabneworIIversion{0.85c}

\ProvidesPackage{latex-lab-testphase-new-or-2}
        [\ltlabneworIIdate\space v\ltlabneworIIversion\space
         Changes to the output routine]
\def \@makecol {%
  \setbox\@outputbox \box\@cclv
  \@outputbox@removebskip
  \@kernel@tagsupport@@makecol
  \let\@elt\relax
  \xdef\@freelist{\@freelist\@midlist}%
  \global \let \@midlist \@empty
  \UseSocket{@makecol/outputbox}%
  \ifvbox\@kludgeins
     \@make@specialcolbox
  \else
     \@make@normalcolbox
  \fi
  \global \maxdepth \@maxdepth
}
\newdimen\@outputbox@depth
\def \@make@normalcolbox {%
   \setbox\@outputbox \vbox to\@colht {%
       \@texttop
       \@outputbox@depth \dp\@outputbox
       \unvbox \@outputbox
       \vskip -\@outputbox@depth
       \@textbottom
      }%
}
\def \@make@specialcolbox {%
   \@outputbox@append {\vskip-\@outputbox@depth}%
   \@tempdima \@colht
   \ifdim \wd\@kludgeins>\z@
     \advance \@tempdima -\ht\@outputbox
     \advance \@tempdima \pageshrink
     \setbox\@outputbox \vbox to \@colht {%
       \unvbox\@outputbox
       \vskip \@tempdima
       \@textbottom
       }%
   \else
     \advance \@tempdima -\ht\@kludgeins
     \setbox \@outputbox \vbox to \@colht {%
       \vbox to \@tempdima {%
         \unvbox\@outputbox
         \@textbottom}%
       \vss}%
   \fi
   {\setbox \@tempboxa \box \@kludgeins}%
}
\def\@outputbox@removebskip{%
  \ifx\@textbottom\relax \else
    \@outputbox@append{%
      \@tempskipa\lastskip
      \ifnum \gluestretchorder\@tempskipa>\z@
        \vskip-\@tempskipa
        \xdef\@outputbox@reinsertbskip
            {\noexpand\@outputbox@append{\vskip\the\@tempskipa}}%
      \else
        \global\let\@outputbox@reinsertbskip\relax
      \fi
    }%
 \fi
}
\let\@outputbox@reinsertbskip\relax
\providecommand\@kernel@before@cclv{}
\providecommand\@kernel@before@footins{}
\def\@outputbox@append #1{%
     \setbox\@outputbox \vbox {%
       \boxmaxdepth \@maxdepth
       \@outputbox@depth\dp\@outputbox      % if needed in #1
       \unvbox \@outputbox
       #1%
     }%
}
\def\@outputbox@appendfootnotes {%
   \ifvoid\footins \else
     \@makecol@handlesplitfootnotes
     \UseSocket{@makecol/footnotes}%
     \@outputbox@append{%
       \vskip \skip\footins
       \@kernel@before@footins
       \color@begingroup
         \normalcolor
         \footnoterule
         \csname pdfcolfoot@current\endcsname
         \unvbox \footins
       \color@endgroup
      }%
  \fi
}
\let \@outputbox@attachfloats \@combinefloats
\def \@outputbox@attachtopfloats {%
  \ifx \@toplist\@empty \else \@cflt \fi
}
\def \@outputbox@attachbottomfloats {%
    \ifx \@botlist\@empty \else \@cflb \fi
}
\def\@makecol@handlesplitfootnotes {%
  \ifnum\insertpenalties>\z@
    \@makecol@splitfootnotemessagehook
  \fi
}
\let \@makecol@splitfootnotemessagehook \@empty
\NewSocket{@makecol/footnotes}{0}
\def\@if@flushbottom@TF{%
  \ifx\@textbottom\relax
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\def\@if@footnotes@TF{%
  \ifvoid\footins
    \expandafter\@secondoftwo
  \else
    \expandafter\@firstoftwo
  \fi
}
\def\@if@bfloats@TF{%
  \ifx \@botlist\@empty
    \expandafter\@secondoftwo
  \else
    \expandafter\@firstoftwo
  \fi
}
\NewSocket{@makecol/outputbox}{0}
\NewSocketPlug {@makecol/outputbox}{space-footnotes-floats} {%
  \@if@footnotes@TF
      {\@outputbox@append{\vfill}}%
      {\@if@bfloats@TF
        {\@outputbox@append{\vfill}}%
        {\@outputbox@reinsertbskip}%
      }%
  \@outputbox@appendfootnotes
  \@outputbox@attachfloats
}
\NewSocketPlug {@makecol/outputbox}{floats-footnotes-space} {%
  \@outputbox@attachfloats
  \@if@footnotes@TF
      {\@outputbox@append{\vfill}}%
      {\@outputbox@reinsertbskip}%
  \@outputbox@appendfootnotes
}
\NewSocketPlug {@makecol/outputbox}{footnotes-space-floats} {%
  \@outputbox@appendfootnotes
  \@if@bfloats@TF
      {\@outputbox@append{\vfill}}%
      {\@outputbox@reinsertbskip}%
  \@outputbox@attachfloats
}
\NewSocketPlug {@makecol/outputbox}{space-floats-footnotes} {%
  \@if@footnotes@TF
      {\@outputbox@append{\vfill}}%
      {\@if@bfloats@TF
        {\@outputbox@append{\vfill}}%
        {\@outputbox@reinsertbskip}}%
  \@outputbox@attachfloats
  \@outputbox@appendfootnotes
}
\NewSocketPlug {@makecol/outputbox}{floats-footnotes} {%
  \@outputbox@attachfloats
  \@outputbox@appendfootnotes
  \@outputbox@reinsertbskip
}
\NewSocketPlug {@makecol/outputbox}{footnotes-floats} {%
  \@outputbox@appendfootnotes
  \@outputbox@attachfloats
  \@outputbox@reinsertbskip
}
\AssignSocketPlug {@makecol/outputbox}{footnotes-floats}
\declare@file@substitution{footmisc.sty}{latex-lab-footmisc.ltx}
\input{latex-lab-footnotes.ltx}
\endinput
%%
%% End of file `latex-lab-testphase-new-or-2.sty'.
